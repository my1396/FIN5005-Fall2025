// Global font family
body, html {
    font-family: -apple-system, system-ui, BlinkMacSystemFont, "Helvetica Neue", Helvetica, Arial, SimSun, sans-serif !important;
}

// MathJax theme-aware color overrides - target MJX-MSTYLE elements specifically
// LIGHT MODE: dark green (#006600) for better contrast
// DARK MODE: light green (#90EE90) for better visibility

/* Filter approach - catch anything green-ish in math */
mjx-container * {
  filter: none; // Reset any existing filters
}

/* In light mode: any green gets forced to DARK green - target MJX-MSTYLE specifically */
mjx-container mjx-mstyle[style*="rgb(0, 204, 102)"],
mjx-container mjx-mstyle[style*="rgb(0,204,102)"],
mjx-container mjx-mstyle[style*="color: rgb(0, 204, 102)"],
mjx-container mjx-mstyle[style*="color:rgb(0,204,102)"],
mjx-container *[style*="#00AA00"],
mjx-container *[style*="#006600"],
mjx-container *[style*="#00CC66"],
mjx-container *[style*="color:#00AA00"],
mjx-container *[style*="color:#006600"], 
mjx-container *[style*="color:#00CC66"],
mjx-container *[style*="color: #00AA00"],
mjx-container *[style*="color: #006600"], 
mjx-container *[style*="color: #00CC66"],
mjx-container *[style*="rgb(0, 170, 0)"],
mjx-container *[style*="rgb(0, 102, 0)"],
mjx-container *[style*="rgb(0, 204, 102)"],
mjx-container *[style*="color: rgb(0, 170, 0)"],
mjx-container *[style*="color: rgb(0, 102, 0)"],
mjx-container *[style*="color: rgb(0, 204, 102)"],
mjx-container *[style*="rgb(0,170,0)"],
mjx-container *[style*="rgb(0,102,0)"],
mjx-container *[style*="rgb(0,204,102)"],
mjx-container *[mathcolor*="#00AA00"],
mjx-container *[mathcolor*="#006600"],
mjx-container *[mathcolor*="#00CC66"],
mjx-container mjx-mstyle[style*="rgb(0, 170, 0)"],
mjx-container mjx-mstyle[style*="rgb(0, 102, 0)"],
mjx-container mjx-mstyle[style*="rgb(0, 139, 69)"],
.MathJax *[style*="#00AA00"],
.MathJax *[style*="#006600"],
.MathJax *[style*="#00CC66"],
.MathJax *[style*="color: #00AA00"],
.MathJax *[style*="color: #006600"],
.MathJax *[style*="color: #00CC66"],
.MathJax *[style*="rgb(0, 170, 0)"],
.MathJax *[style*="rgb(0, 102, 0)"],
.MathJax *[style*="rgb(0, 204, 102)"] {
  color: #006600 !important; /* DARK green for light mode */
  fill: #006600 !important;
  -webkit-text-fill-color: #006600 !important;
}

/* In dark mode: keep LIGHT green - multiple selectors for robustness */
[data-bs-theme="dark"] mjx-container mjx-mstyle[style*="rgb(0, 204, 102)"],
[data-bs-theme="dark"] mjx-container mjx-mstyle[style*="rgb(0,204,102)"],
[data-bs-theme="dark"] mjx-container mjx-mstyle[style*="color: rgb(0, 204, 102)"],
[data-bs-theme="dark"] mjx-container mjx-mstyle[style*="color:rgb(0,204,102)"],
[data-bs-theme="dark"] mjx-container *[style*="#00AA00"],
[data-bs-theme="dark"] mjx-container *[style*="#006600"],
[data-bs-theme="dark"] mjx-container *[style*="#00CC66"],
[data-bs-theme="dark"] mjx-container *[style*="color:#00AA00"],
[data-bs-theme="dark"] mjx-container *[style*="color:#006600"],
[data-bs-theme="dark"] mjx-container *[style*="color:#00CC66"],
[data-bs-theme="dark"] mjx-container *[style*="color: #00AA00"],
[data-bs-theme="dark"] mjx-container *[style*="color: #006600"],
[data-bs-theme="dark"] mjx-container *[style*="color: #00CC66"],
[data-bs-theme="dark"] mjx-container *[style*="rgb(0, 170, 0)"],
[data-bs-theme="dark"] mjx-container *[style*="rgb(0, 102, 0)"],
[data-bs-theme="dark"] mjx-container *[style*="rgb(0, 204, 102)"],
[data-bs-theme="dark"] mjx-container *[style*="color: rgb(0, 170, 0)"],
[data-bs-theme="dark"] mjx-container *[style*="color: rgb(0, 102, 0)"],
[data-bs-theme="dark"] mjx-container *[style*="color: rgb(0, 204, 102)"],
[data-bs-theme="dark"] mjx-container *[style*="rgb(0,170,0)"],
[data-bs-theme="dark"] mjx-container *[style*="rgb(0,102,0)"],
[data-bs-theme="dark"] mjx-container *[style*="rgb(0,204,102)"],
[data-bs-theme="dark"] mjx-container *[mathcolor*="#00AA00"],
[data-bs-theme="dark"] mjx-container *[mathcolor*="#006600"],
[data-bs-theme="dark"] mjx-container *[mathcolor*="#00CC66"],
[data-bs-theme="dark"] mjx-container mjx-mstyle[style*="rgb(0, 170, 0)"],
[data-bs-theme="dark"] mjx-container mjx-mstyle[style*="rgb(0, 102, 0)"],
[data-bs-theme="dark"] mjx-container mjx-mstyle[style*="rgb(0, 139, 69)"],
[data-bs-theme="dark"] .MathJax *[style*="#00AA00"],
[data-bs-theme="dark"] .MathJax *[style*="#006600"],
[data-bs-theme="dark"] .MathJax *[style*="#00CC66"],
[data-bs-theme="dark"] .MathJax *[style*="color: #00AA00"],
[data-bs-theme="dark"] .MathJax *[style*="color: #006600"],
[data-bs-theme="dark"] .MathJax *[style*="color: #00CC66"],
[data-bs-theme="dark"] .MathJax *[style*="rgb(0, 170, 0)"],
[data-bs-theme="dark"] .MathJax *[style*="rgb(0, 102, 0)"],
[data-bs-theme="dark"] .MathJax *[style*="rgb(0, 204, 102)"],
body[data-bs-theme="dark"] mjx-container *[style*="#00AA00"],
body[data-bs-theme="dark"] mjx-container *[style*="#006600"],
body[data-bs-theme="dark"] mjx-container *[style*="#00CC66"],
body[data-bs-theme="dark"] mjx-container *[style*="rgb(0, 170, 0)"],
body[data-bs-theme="dark"] mjx-container *[style*="rgb(0, 102, 0)"],
body[data-bs-theme="dark"] mjx-container *[style*="rgb(0, 204, 102)"],
body[data-bs-theme="dark"] .MathJax *[style*="#00AA00"],
body[data-bs-theme="dark"] .MathJax *[style*="#006600"],
body[data-bs-theme="dark"] .MathJax *[style*="#00CC66"],
body[data-bs-theme="dark"] .MathJax *[style*="rgb(0, 170, 0)"],
body[data-bs-theme="dark"] .MathJax *[style*="rgb(0, 102, 0)"],
body[data-bs-theme="dark"] .MathJax *[style*="rgb(0, 204, 102)"],
.dark mjx-container *[style*="#00AA00"],
.dark mjx-container *[style*="#006600"],
.dark mjx-container *[style*="#00CC66"],
.dark mjx-container *[style*="rgb(0, 170, 0)"],
.dark mjx-container *[style*="rgb(0, 102, 0)"],
.dark mjx-container *[style*="rgb(0, 204, 102)"],
.dark .MathJax *[style*="#00AA00"],
.dark .MathJax *[style*="#006600"],
.dark .MathJax *[style*="#00CC66"],
.dark .MathJax *[style*="rgb(0, 170, 0)"],
.dark .MathJax *[style*="rgb(0, 102, 0)"],
.dark .MathJax *[style*="rgb(0, 204, 102)"] {
  color: #90EE90 !important; /* LIGHT green for dark mode */
  fill: #90EE90 !important;
  -webkit-text-fill-color: #90EE90 !important;
}

// Remove inner border from input code blocks
.sourceCode {
    border: none !important;
}
pre.sourceCode {
    border: none !important;
}

// R code chunk outputs - remove background
.cell-output,
.cell-output pre,
.cell-output code,
.cell-output .sourceCode {
  background-color: transparent !important;
  background: none !important;
}

// Remove border from kableExtra scroll box div
.cell-output-display div[style*="border"] {
  border: none !important;
}

/**
 * Tables
 */
table {
  border-collapse: collapse;
  border-spacing: 0;
}
th, td {
  border-spacing: 0px;
  padding-top: 0.3rem;
  padding-bottom: 0.3em;
  padding-left: 0.5rem;
  padding-right: 0.5rem;
}

// Bullet lists
p + ul {
  margin-top: 0.5em;
}

p:has(+ ul) {
  margin-bottom: 0.5em;
}



// Callouts
// Add space between callout title and content
.callout .callout-title-container {
  margin-bottom: 0.5em;
}

// Set all callout types font size to match body text (1rem)
.callout.callout-important .callout-body-container,
.callout.callout-tip .callout-body-container,
.callout.callout-warning .callout-body-container, 
.callout.callout-caution .callout-body-container,
.callout.callout-note .callout-body-container {
  font-size: 1rem;
}

// Solution toggle button styling
.solution-btn {
  background: none;
  border: 1px solid currentColor;
  padding: 0.25rem 0.6rem;
  font-size: 0.85rem;
  cursor: pointer;
  border-radius: 4px;
  margin-bottom: 0.6rem; /* added spacing below solution buttons */
  display: inline-block;
}

.solution-btn:hover {
  opacity: 0.8;
}

// Answer box (will get color via .env-green in theme-specific files)
.solution-answer {
  padding: 0.4rem 0.6rem;
  border-left: 4px solid currentColor;
  margin: 0.4rem 0 0.8rem 0;
  display: none; // hidden by default until toggled
}

/* User defined numbered list prefixed with Step */
.step-list ol {
  counter-reset: step;
  margin: 0 !important;
  padding: 0 !important;
}

/* Hanging indent: reserve space for the Step label so all following content (including code blocks) lines up */
/* Step item: first line (title) flush; later blocks indented */
.step-list ol>li {
  list-style: none;
  counter-increment: step;
  position: relative;
  margin: 0.4rem 0; /* vertical spacing */
}

/* Step label + hanging indent */
:root { --step-label-width: 6ch; }
/* Reserve label column using absolute positioned pseudo-element */
.step-list ol>li {
  padding-left: var(--step-label-width); /* content (including first line) starts after label */
}
.step-list ol>li:before {
  content: 'Step ' counter(step) '. ';
  font-weight: 600;
  position: absolute;
  left: 0;
  top: 0; /* aligns with first line */
  width: var(--step-label-width);
  display: inline-block;
}
/* First paragraph normal block (no extra indent) */
.step-list ol>li > p:first-child { margin-top: 0; }
/* Subsequent blocks align with first text line automatically (inherit li padding); no extra left margin */
.step-list ol>li > *:not(:first-child) { margin-left: 0; }
/* Avoid nested lists double-indenting; they can add their own bullets with slight padding */
.step-list ol>li > *:not(:first-child) ul,
.step-list ol>li > *:not(:first-child) ol { margin-left: 1.2em; }

